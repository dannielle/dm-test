<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Decatur Maker + BNR Test</title>
    <meta name="description" content="Decatur Maker + BNR Test">
    <script src="https://aframe.io/releases/0.2.0/aframe.min.js"></script>

    <script>
      (function() {
      'use strict';

      var alongpathComp = {
        schema: {
          path     : { default: ''    },
          closed   : { default: false },
          dur      : { default: 1000  }
        },

        init: function() {
          var ent = this.el;
          var d = this.data;
          var points = d.path.split(' ').map(function(p) {
              p = p.split(',');
              return new THREE.Vector3(
                  parseFloat(p[0]),
                  parseFloat(p[1]),
                  parseFloat(p[2])
              );
          });
          var ctor = d.closed ? 'ClosedSplineCurve3' : 'SplineCurve3';
          var curve = new THREE[ctor](points);

          var onFrame = function onFrame(t) {
            window.requestAnimationFrame(onFrame);
            t = t % d.dur;
            var i = t / d.dur;
            try {
              var p = curve.getPoint(i);
              ent.setAttribute('position', p);
            } catch (ex) {}
          };

          onFrame();
        },

        update: function(oldData) {},

        remove: function() {}
      };

      AFRAME.registerComponent('alongpath', alongpathComp);

      })();
    </script>


  </head>
  <body>
    <a-scene>
      <a-assets>
        <a-asset-item id="model-tiny" src="../models/tiny.dae"></a-asset-item>
        <img id="image-tap-to-continue" src="../images/tap-to-continue.png"></img>        
        <img id="image-sky" src="../images/sky.png"></img>
      </a-assets>

      <a-collada-model src="#model-tiny" scale="5 5 5" position="0 -10 0" rotation="0 45 0" onClick="location.href='../demos/photos.html'" >
        <a-light color="#FFCC00" position="2 -5 4" intensity="0.5"></a-light>
      </a-collada-model>

      <!-- inside -->
      <a-light color="#FFCC00" position="-10 0 -30" intensity="0.5"></a-light>
      <!-- right side -->
      <a-light color="#FFCC00" position="-25 10 -10" intensity="0.5"></a-light>
      <a-light type="ambient" color="#7c6cbf" intensity="0.5"></a-light>
      <a-sky src="#image-sky"></a-sky>

      <a-image id="tap-to-continue" src="#image-tap-to-continue" onClick="location.href='../demos/photos.html'" position="5 0 -20" rotation="0 45 0" scale="5 5 5"></a-image>

      <a-entity position="0 0 5">
        <a-entity camera look-controls id="player"
          alongpath="path:0,0,0 25,15,-30 0,5,-65 -10,0,-30 -25,5,-10; closed:true; dur:50000">
          <a-cursor color="#FFFFAA"></a-cursor>
        </a-entity>
      </a-entity>
    </a-scene>
  </body>
  <script>
      var sceneEl = document.getElementsByTagName('a-scene')[0];

      sceneEl.addEventListener('loaded', function() {

      });

  </script>
</html>
